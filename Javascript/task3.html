<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Tax Slab Calculation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: #f5f5f5;
      }

      .card {
        border: 2px solid #0d6efd;
        margin-bottom: 20px;
      }

      .output-box {
        background: #fff;
      }

      .no-tax {
        background: #d4edda;
      }

      .taxable {
        background: #0b1c3d;
        color: #fff;
      }
    </style>
  </head>

  <body>
    <div class="container mt-4">
      <div class="card p-4">
        <h4 class="text-center border p-2 mb-3">TAX SLAB CALCULATION</h4>

        <form class="needs-validation" novalidate>
          <!-- INPUT SECTION -->
          <div class="row g-3">
            <div class="col-md-3">
              <label>Name:</label>
              <input
                id="name"
                class="form-control"
                placeholder="Name"
                onkeypress="return ((event.charCode>=65 && event.charCode<=90) || (event.charCode>=97 && event.charCode<=122) || event.charCode===32)"
                required
              />
              <div class="invalid-feedback">Enter Name</div>
            </div>

            <div class="col-md-3">
              <label>Mobile Number:</label>
              <input
                id="mobile"
                class="form-control"
                pattern="[0-9]{10}"
                onkeypress="return event.charCode>=48 && event.charCode<=57"
                maxlength="10"
                placeholder="Mobile"
                required
              />
              <div class="invalid-feedback">Enter 10 digit Mobile</div>
            </div>

            <div class="col-md-3">
              <label>Birthdate:</label>
              <input type="date" id="dob" class="form-control" required />
              <div class="invalid-feedback">Select Birthdate</div>
            </div>

            <div class="col-md-3">
              <label>Gender:</label>
              <select id="gender" class="form-select" required>
                <option value="">Select Gender</option>
                <option value="men">Men</option>
                <option value="women">Women</option>
                <option value="senior">Senior Citizen</option>
              </select>
              <div class="invalid-feedback">Select Gender</div>
            </div>

            <div class="col-md-4">
              <label>Income:</label>
              <input
                id="income"
                class="form-control"
                placeholder="Income Amount"
                type="number"
                min="0"
                required
              />
              <div class="invalid-feedback">Enter Income</div>
            </div>

            <div class="col-md-4">
              <label>Loan Amount:</label>
              <input
                id="loan"
                class="form-control"
                placeholder="Loan Amount"
                type="number"
                min="0"
                required
              />
              <div class="invalid-feedback">Enter Loan</div>
            </div>

            <div class="col-md-4">
              <label>Investment:</label>
              <input
                id="investment"
                class="form-control"
                placeholder="Investment Amount"
                type="number"
                min="0"
                required
              />
              <div class="invalid-feedback">Enter Investment</div>
            </div>
          </div>

          <!-- BUTTONS -->
          <div class="mt-3 text-center">
            <button
              type="button"
              class="btn btn-success"
              onclick="calculateTax()"
            >
              CALCULATE
            </button>
            <button
              type="reset"
              class="btn btn-warning"
              onclick="resetResult()"
            >
              RESET
            </button>
          </div>

          <!-- OUTPUT -->
          <h5 class="mt-4">OUTPUT:</h5>
          <div class="row g-3 output-box p-3 mt-1">
            <div class="col-md-4">
              <label>Name:</label>
              <input
                id="outName"
                class="form-control"
                placeholder="Name"
                readonly
              />
            </div>
            <div class="col-md-4">
              <label>Taxable amount:</label>
              <input
                id="taxableAmount"
                class="form-control"
                placeholder="Taxable Amount"
                readonly
              />
            </div>
            <div class="col-md-4">
              <label>Payable amount:</label>
              <input
                id="payableTax"
                class="form-control"
                placeholder="Payable Tax"
                readonly
              />
            </div>
          </div>

          <!-- TAX SLABS -->
          <div class="row mt-4">
            <div class="col-md-4">
              <strong>For Men:</strong><br />
              upto 2.4L - NO TAX<br />
              2.4L to 6L - 10%<br />
              above 6L - 20%
            </div>
            <div class="col-md-4">
              <strong>For Women:</strong><br />
              upto 2.6L - NO TAX<br />
              2.6L to 7L - 10%<br />
              above 7L - 20%
            </div>
            <div class="col-md-4">
              <strong>For Senior Citizen:</strong><br />
              upto 3L - NO TAX<br />
              3L to 7L - 10%<br />
              above 7L - 20%
            </div>
          </div>

          <!-- NOTES -->
          <div class="mt-3">
            <strong>Notes:</strong><br />
            1. Loan exemption = min(80% of Loan, 20% of Income)<br />
            2. Investment upto â‚¹1,00,000 is non-taxable<br />
            3. Green = No Tax | Navy Blue = Taxable
          </div>
        </form>
      </div>
    </div>

    <script>
      (function () {
        "use strict";
        const forms = document.querySelectorAll(".needs-validation");
        Array.from(forms).forEach((form) => {
          form.addEventListener("submit", (e) => {
            if (!form.checkValidity()) {
              e.preventDefault();
              e.stopPropagation();
            }
            form.classList.add("was-validated");
          });
        });
      })();

      function calculateTax() {
        const form = document.querySelector(".needs-validation");
        if (!form.checkValidity()) {
          form.classList.add("was-validated");
          return;
        }

        const name = document.getElementById("name").value;
        const gender = document.getElementById("gender").value;
        const income = Number(document.getElementById("income").value);
        const loan = Number(document.getElementById("loan").value);
        const investment = Number(document.getElementById("investment").value);

        const loanExempt = Math.min(loan * 0.8, income * 0.2);
        const investExempt = Math.min(investment, 100000);

        let taxable = income - loanExempt - investExempt;
        if (taxable < 0) taxable = 0;

        let tax = 0;

        if (gender === "men") {
          if (taxable > 600000) tax = taxable * 0.2;
          else if (taxable > 240000) tax = taxable * 0.1;
        }
        if (gender === "women") {
          if (taxable > 700000) tax = taxable * 0.2;
          else if (taxable > 260000) tax = taxable * 0.1;
        }
        if (gender === "senior") {
          if (taxable > 700000) tax = taxable * 0.2;
          else if (taxable > 300000) tax = taxable * 0.1;
        }

        document.getElementById("outName").value = name;
        document.getElementById("taxableAmount").value = taxable.toFixed(2);
        document.getElementById("payableTax").value = tax.toFixed(2);

        const box = document.getElementById("payableTax");
        box.className = "form-control " + (tax === 0 ? "no-tax" : "taxable");
      }

      function resetResult() {
        const form = document.querySelector(".needs-validation");

        // Reset all inputs
        form.reset();

        // Remove bootstrap validation
        form.classList.remove("was-validated");

        // Clear output fields
        document.getElementById("outName").value = "";
        document.getElementById("taxableAmount").value = "";
        document.getElementById("payableTax").value = "";

        // Remove color classes
        const taxBox = document.getElementById("payableTax");
        taxBox.classList.remove("no-tax", "taxable");
      }
    </script>
  </body>
</html>
