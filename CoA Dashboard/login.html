<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - CoA Dashboard</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <style>
    body {
      background-color: #f5f5f5;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
    }

    .login-container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 40px;
      width: 100%;
      max-width: 400px;
    }

    .logo-section {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo-section img {
      width: 80px;
      height: auto;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid #dee2e6;
    }

    .logo-section h2 {
      color: #212529;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 24px;
    }

    .logo-section p {
      color: #6c757d;
      font-size: 13px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      font-weight: 500;
      color: #212529;
      margin-bottom: 8px;
      display: block;
      font-size: 13px;
    }

    .input-group {
      display: flex;
      align-items: center;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      background: #fff;
      transition: border-color 0.3s;
    }

    .input-group:focus-within {
      border-color: #0d6efd;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }

    .input-group-text {
      border: none;
      background: transparent;
      color: #6c757d;
      padding: 10px 12px;
      min-width: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .input-group input {
      border: none;
      padding: 10px 12px;
      font-size: 13px;
      outline: none;
      flex: 1;
      background: transparent;
    }

    .input-group input::placeholder {
      color: #adb5bd;
    }

    .input-group input:focus {
      outline: none;
    }

    .btn-login {
      width: 100%;
      padding: 10px;
      background-color: #0d6efd;
      color: white;
      border: none;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s, box-shadow 0.2s;
      margin-top: 10px;
      font-size: 13px;
    }

    .btn-login:hover {
      background-color: #0b5ed7;
      box-shadow: 0 2px 8px rgba(13, 110, 253, 0.3);
    }

    .btn-login:active {
      background-color: #0a58ca;
    }

    .error-message {
      color: #dc3545;
      font-size: 12px;
      margin-top: 5px;
      display: none;
      padding: 8px;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      border-radius: 4px;
    }

    .success-message {
      color: #155724;
      font-size: 12px;
      margin-top: 5px;
      display: none;
      padding: 8px;
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
      border-radius: 4px;
    }

    .info-text {
      text-align: center;
      color: #6c757d;
      font-size: 12px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #dee2e6;
    }

    .info-text i {
      color: #0d6efd;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div class="login-container">
    <div class="logo-section">
      <h2>CoA Dashboard</h2>
      <p>Standardizer Login</p>
    </div>

    <form id="loginForm">
      <div class="form-group">
        <label>Email or Mobile Number *</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-person"></i></span>
          <input
            type="text"
            id="emailOrMobile"
            placeholder="Enter email or mobile number"
            required
          />
        </div>
        <div class="error-message" id="emailMobileError"></div>
      </div>

      <div class="form-group">
        <label>Password (Optional)</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-lock"></i></span>
          <input
            type="password"
            id="password"
            placeholder="Enter password (optional)"
          />
        </div>
      </div>

      <button type="submit" class="btn btn-login">
        <i class="bi bi-box-arrow-in-right me-2"></i> Login
      </button>

      <div class="error-message" id="generalError"></div>
      <div class="success-message" id="successMessage"></div>

      <div class="info-text">
        <i class="bi bi-info-circle"></i>
        Email or mobile number is required to login
      </div>
    </form>
  </div>

 <script>
  // Helpers
  const isValidEmail = (v) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
  const isValidMobile = (v) => /^\d{10}$/.test(v.replace(/\s+/g, ''));

  const generateJWT = (user) => {
    const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));
    const payload = btoa(JSON.stringify({
      sub: user,
      iat: Date.now(),
      exp: Date.now() + 24 * 60 * 60 * 1000
    }));
    return `${header}.${payload}.signature`;
  };

  // Login handler
  document.getElementById('loginForm').addEventListener('submit', (e) => {
    e.preventDefault();

    const user = emailOrMobile.value.trim();
    emailMobileError.style.display = 'none';
    generalError.style.display = 'none';
    successMessage.style.display = 'none';

    if (!user || (!isValidEmail(user) && !isValidMobile(user))) {
      emailMobileError.textContent =
        'Enter a valid email or 10-digit mobile number';
      emailMobileError.style.display = 'block';
      return;
    }

    try {
      localStorage.setItem('jwtToken', generateJWT(user));
      localStorage.setItem('loginEmail', user);

      successMessage.textContent = 'âœ“ Login successful! Redirecting...';
      successMessage.style.display = 'block';

      setTimeout(() => (window.location.href = 'dashboard.html'), 1000);
    } catch {
      generalError.textContent = 'Login failed. Please try again.';
      generalError.style.display = 'block';
    }
  });
</script>

</body>
</html>
